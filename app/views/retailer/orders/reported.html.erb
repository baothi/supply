<% content_for :title, "Orders" %>
<% content_for :main_menu, Hingeto::Section::ORDERS %>
<% content_for :inner_menu, Hingeto::Section::REPORTED_ORDERS %>
<body class="animsition page-aside-static page-aside-left">
<%= render "shared/outdated_browser" %>
<%= render "shared/nav_bar" %>
<%= render "retailer/shared/side_menu" %>
<%= render "shared/grid_menu" %>

  <div class="page">
    <%#= render "retailer/orders/shared/menu" %>
    <div class="page-main">
      <div class="page-header">
        <h1 class="page-title">Reported Orders</h1>

        <%= render :partial=>"shared/alerts" %>
      </div>

      <div class="page-content">
        <div class="panel">
          <div class="panel-body">
            <span><strong>Available Credit: </strong> <%= number_to_currency(current_retailer.total_available_credit) %></span>
          </div>
        </div>
        <div class="panel">
          <div class="panel-body">
            <!-- Filters -->
            <div class="row">
              <div class="col-md-12">
                <div class="form-group">
                <%= form_tag(retailer_orders_reported_path, method: :get) do %>
                  <div class="input-group">
                    <%= text_field_tag :q, params[:q], class: "form-control", placeholder: "Enter Keyword" %>
                    <div class="input-group-btn">
                      <%= button_tag(type: "submit", class: "btn btn-default btn-outline", :name => nil) do %>
                        <i class="icon wb-search" aria-hidden="true"></i>Search
                      <% end %>
                    </div>
                  </div>
                <% end %>
                </div>
              </div>
            </div>

            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Order #</th>
                    <th>Amount Paid</th>
                    <th>Report Description</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <% @orders.each do |order| %>
                    <tr>
                      <td>
                        <%= link_to retailer_order_details_path(id: order.internal_identifier) do %>
                            <%= order.retailer_shopify_name || order.number %>
                        <% end %>
                      </td>
                      <td><%= number_to_currency order.grand_total %></td>
                      <td><%= order.order_issue_report.description %></td>
                      <td>
                        <% if order.order_issue_report.resolved? %>
                          <% if order.order_issue_report.declined? %>
                            <span class="tag tag-danger">« declined »</span>
                          <% else %>
                            <span class="tag tag-success">« credited »</span>
                          <% end %>
                        <% else %>
                          <span class="tag tag-warning">« pending »</span>
                        <% end %>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
          <div class="panel-footer">
            <%= paginate @orders , theme: 'twitter-bootstrap-4' %>
          </div>
        </div>
      </div>
    </div>
  </div>

</body>

